<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Checkliste Sicherheitsprüfung</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f0f0f0; }
    td.center { text-align: center; }
    button { margin-top: 20px; padding: 10px 20px; background-color: #007acc; color: white; border: none; font-size: 16px; border-radius: 5px; cursor: pointer; }
    button:hover { background-color: #005fa3; }
  </style>
</head>
<body>

  <h2>Checkliste Sicherheitsprüfung – Gesamtmarkt</h2>

  <table id="checklist">
    <thead>
      <tr>
        <th>Frage</th>
        <th class="center">Ja</th>
        <th class="center">Nein</th>
        <th class="center">Nicht vorhanden</th>
      </tr>
    </thead>
    <tbody>
      <!-- Fragen automatisch generiert -->
      <script>
        const fragen = [
          "Im gesamten Markt wird geeignetes Schuhwerk getragen (feste, geschlossene, flache Schuhe)",
          "Automatiktüren, Rolltore, Schnelllauftore sind geprüft und ohne sichtbare Beschädigungen",
          "Die Aufzugsanlage ist geprüft und in einem ordnungsgemäßen Zustand",
          "Die Leergutrücknahme ist in einem ordnungsgemäßen Zustand",
          "Die Leitern sind geprüft und dokumentiert",
          "Es werden geeignete Sicherheitsmesser verwendet",
          "Keine sichtbaren Beschädigungen an Schaltern/Steckdosen",
          "Gabelhubwagen ist in einem ordnungsgemäßen Zustand",
          "Elektrischer Hubwagen ist geprüft und gesichert",
          "Feuerlöscheinrichtungen sind frei zugänglich",
          "Feuerlöscher sind geprüft (Prüffristen eingehalten)",
          "Brandschutztüren sind nicht zugestellt",
          "Türhaltevorrichtungen sind in Ordnung",
          "Brandschutztüren sind ohne Beschädigung",
          "Flucht- und Rettungsplan ist aktuell vorhanden",
          "Notausgangsbeleuchtung ohne Defekte",
          "Notausgänge sind frei zugänglich",
          "Notausgänge sind von innen ohne fremde Hilfe zu öffnen",
          "Notausgänge führen in sichere Bereiche",
          "Verkehrswege sind sicher (keine Stolperstellen)",
          "Treppen sind unbeschädigt und frei",
          "Persönliche Schutzausrüstung ist verfügbar",
          "Technikräume werden nicht als Lagerräume genutzt",
          "Betriebsanweisungen sind gut zugänglich"
        ];

        document.write(fragen.map((frage, i) => `
          <tr>
            <td>${frage}</td>
            <td class="center"><input type="radio" name="frage${i}" value="Ja"></td>
            <td class="center"><input type="radio" name="frage${i}" value="Nein"></td>
            <td class="center"><input type="radio" name="frage${i}" value="Nicht vorhanden"></td>
          </tr>
        `).join(''));
      </script>
    </tbody>
  </table>

  <button onclick="generatePDF()">PDF generieren & teilen</button>

  <script>
    function generatePDF() {
      const checklist = document.getElementById("checklist");
      const clone = checklist.cloneNode(true);
      const inputs = clone.querySelectorAll('input');

      inputs.forEach(input => {
        if (input.checked) {
          const td = input.parentElement;
          td.innerText = input.value;
        } else {
          input.remove();
        }
      });

      const wrapper = document.createElement('div');
      const title = document.createElement('h3');
      title.innerText = 'Checkliste Sicherheitsprüfung – PDF';
      wrapper.appendChild(title);
      wrapper.appendChild(clone);

      const opt = {
        margin:       0.5,
        filename:     'checkliste-sicherheitspruefung.pdf',
        image:        { type: 'jpeg', quality: 0.98 },
        html2canvas:  { scale: 2 },
        jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' }
      };

      html2pdf().from(wrapper).set(opt).outputPdf('blob').then((blob) => {
        const url = URL.createObjectURL(blob);
        window.open(url); // iPad: Öffnet PDF und erlaubt Teilen/Speichern
      });
    }
  </script>

</body>
</html>
