<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Sicherheits-Checkliste">
    <title>Sicherheits- und Betriebs-Checkliste</title>
   <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
<link href="/sicher/favicon.ico" rel="icon" type="image/x-icon" />
<link href="/sicher/manifest.json" rel="manifest"/>
<style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #e6f7ff; }
        .container { max-width: 1000px; margin: auto; background: #f0fbff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        h1 { text-align: center; }
        #header-fields { display: flex; justify-content: flex-start; align-items: center; gap: 20px; margin-bottom: 10px; }
        #header-fields div { display: flex; flex-direction: column; }
        #header-fields label { font-weight: bold; margin-bottom: 4px; }
        #header-fields input { padding: 6px; border: 1px solid #ccc; border-radius: 4px; width: 150px; }
        #ipad-instructions { background: #e7f3fe; border: 1px solid #8ebfef; padding: 10px; border-radius: 5px; margin-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #333; padding: 8px; text-align: left; vertical-align: top; }
        th { background-color: #d9f2ff; }
        .checkbox { width: 30px; text-align: center; }
        textarea { width: 100%; height: 2em; }
        #controls { display: flex; justify-content: flex-start; gap: 10px; margin-top: 10px; }
        button { padding: 8px 12px; font-size: 1em; }
        #mailBtn { position: fixed; bottom: 20px; right: 20px; }
        .custom-btn { background-color: #28a745; color: white; border: none; border-radius: 4px; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
<div class="container">
    <h1>Sicherheits- und Betriebs-Checkliste</h1>
    <div id="header-fields">
        <div>
            <label for="date">Datum</label>
            <input type="text" id="date" readonly>
        </div>
        <div>
            <label for="marktnummer">Marktnummer</label>
            <input type="text" id="marktnummer" placeholder="Eingabe...">
        </div>
        <div>
            <label for="sifa">Sicherheitsbeauftragter</label>
            <input type="text" id="sifa" placeholder="Eingabe...">
        </div>
    </div>
    <div id="ipad-instructions">
        <strong>Hinweis f√ºr iPad-Nutzer:</strong> In Safari auf das Teilen-Symbol tippen und <em>Zum Home-Bildschirm</em> w√§hlen, um die Checkliste als App zu nutzen.
    </div>
    <table id="checklist">
        <thead>
            <tr>
                <th>Nr.</th>
                <th>Pr√ºffrage</th>
                <th class="checkbox">Ja</th>
                <th class="checkbox">Nein</th>
                <th>Bemerkung</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <div id="controls">
        <button id="shareBtn" style="display:none;">Teilen</button>
        <button id="printBtn">Drucken</button>
        <button id="pdfBtn">PDF generieren</button>
    </div>
        <!-- ... innerhalb der .container ... -->
    
<!-- Unterschriftenfeld -->
<div style="margin-top: 30px;">
    <label for="signature" style="font-weight: bold;">Unterschrift:</label>
    <div style="
        margin-top: 8px;
        width: 100%;
        max-width: 600px;
        height: 150px;
        border: 2px dashed #aaa;
        border-radius: 12px;
        background-color: #fff;
        position: relative;
    ">
        <canvas id="signatureCanvas" width="600" height="150" style="width: 100%; height: 100%; border-radius: 12px;"></canvas>
    </div>
    <button onclick="clearSignature()" style="margin-top: 10px; background-color: #dc3545; color: white; border: none; border-radius: 4px; padding: 6px 12px;">
        Unterschrift l√∂schen
    </button>
</div>
<script>
function clearSignature() {
    const canvas = document.getElementById('signatureCanvas');
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);
}
window.addEventListener('load', () => {
    const canvas = document.getElementById('signatureCanvas');
    const ctx = canvas.getContext('2d');
    let drawing = false;

    function startDraw(e) {
        drawing = true;
        ctx.beginPath();
        ctx.moveTo(e.offsetX, e.offsetY);
    }
    function draw(e) {
        if (!drawing) return;
        ctx.lineTo(e.offsetX, e.offsetY);
        ctx.stroke();
    }
    function endDraw() {
        drawing = false;
    }

    canvas.addEventListener('mousedown', startDraw);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', endDraw);
    canvas.addEventListener('mouseout', endDraw);

    // Touch support
    canvas.addEventListener('touchstart', e => {
        const rect = canvas.getBoundingClientRect();
        const touch = e.touches[0];
        const x = touch.clientX - rect.left;
        const y = touch.clientY - rect.top;
        drawing = true;
        ctx.beginPath();
        ctx.moveTo(x, y);
        e.preventDefault();
    });

    canvas.addEventListener('touchmove', e => {
        if (!drawing) return;
        const rect = canvas.getBoundingClientRect();
        const touch = e.touches[0];
        const x = touch.clientX - rect.left;
        const y = touch.clientY - rect.top;
        ctx.lineTo(x, y);
        ctx.stroke();
        e.preventDefault();
    });

    canvas.addEventListener('touchend', () => {
        drawing = false;
    });
});
</script>

    
<button onclick="window.location.reload();" class="custom-btn" style="width:100%; margin:10px 0 20px; background-color: #007bff;">
  üîÑ Seite neu laden
</button>

    <button onclick="generateAndSharePDF()" class="custom-btn" style="width:100%; margin:10px 0 20px;">
      üì§ PDF teilen (iPad)
    </button>
</div>

<script>
// Sicherstellen, dass das DOM vollst√§ndig geladen ist
window.addEventListener('DOMContentLoaded', () => {
    // Auto-Datum
    document.getElementById('date').value = new Date().toLocaleDateString('de-DE');

    // Pr√ºffragen-Array
    const fragen = [
        /* Alle Fragen hier */ 


    
  "Werden Technik- und Heizr√§ume als Lagerr√§ume genutzt?",
  "Befindet sich brennbares Material (z.‚ÄØB. Kisten, Kartons) in den Technik- oder Heizr√§umen?",
  "Sind die Treppen unbesch√§digt und frei von Gegenst√§nden?",
  "Sind die Verkehrswege so beschaffen, dass kein Risiko zum Stolpern, Ausrutschen oder Umknicken besteht?",
  "Wird im gesamten Markt geeignetes Schuhwerk getragen (feste, geschlossene, flache Schuhe)?",
  "Sind Automatikt√ºren, Rolltore und Schnelllauftore gepr√ºft und ohne sichtbare Besch√§digungen?",
  "Ist die Aufzugsanlage gepr√ºft und in einem ordnungsgem√§√üen Zustand (keine sichtbare Besch√§digung, funktionsf√§hige Schutzeinrichtungen)?",
  "Ist die Leergutr√ºcknahme in einem ordnungsgem√§√üen Zustand (intakte Schutzeinrichtungen, gesicherte Einzugsstellen, keine Glasscherben)?",
  "Stehen geeignete Handschuhe f√ºr die Leergutr√ºcknahme zur Verf√ºgung?",
  "Sind Leitern gepr√ºft gem√§√ü 'Leitern und Tritte' (BGV D36 bzw. GUV-VD360)?",
  "Ist das Leiter-Kontrollblatt im Ordner Arbeitssicherheit abgelegt?",
  "Werden aus dem Ordersatz geeignete Sicherheitsmesser verwendet?",
  "Sind zur Zeit der Begehung keine sichtbaren Besch√§digungen an Schaltern und Steckdosen vorhanden?",
  "Ist der Gabelhubwagen in einem ordnungsgem√§√üen Zustand ohne sichtbare Besch√§digungen?",
  "Ist der elektrische Hubwagen gepr√ºft und in einem ordnungsgem√§√üen Zustand (keine sichtbaren Besch√§digungen, funktionsf√§hige Schutzeinrichtungen)?",
  "Ist der elektrische Hubwagen gegen unbefugte Benutzung gesichert?",
  "Werden Sicherheitsschuhe getragen?",
  "Sind die Feuerl√∂scheinrichtungen frei zug√§nglich und nicht blockiert?",
  "Sind die Feuerl√∂scheinrichtungen gepr√ºft und werden Pr√ºffristen eingehalten?",
  "Sind Brandschutzt√ºren frei von Zugestellungen und wird ihre Funktion nicht gest√∂rt?",
  "Sind T√ºrhaltevorrichtungen und Schlie√üfolgeregler des Feuerschutzabschlusses in Ordnung?",
  "Sind Brandschutzt√ºren ohne Besch√§digungen?",
  "Ist ein aktueller Flucht- und Rettungsplan vorhanden?",
  "Ist die Notausgangsbeleuchtung ohne Defekte?",
  "Sind Notausg√§nge frei zug√§nglich und nicht zugestellt?",
  "Sind Notausg√§nge und -ausstiege von innen ohne fremde Hilfe zu √∂ffnen und nicht zugestellt?",
  "F√ºhren Notausg√§nge in sichere Bereiche?",
  "Wird passende pers√∂nliche Schutzausr√ºstung f√ºr T√§tigkeiten mit Gefahrstoffen (z.B. Schutzbrille, Handschuhe) gestellt?",
  "Sind Betriebsanweisungen gut zug√§nglich?",
  "Werden Sicherheitsanweisungen eingehalten?",
  "Sind die Arbeitsger√§te an der Backstation (Backofen, Backbleche, Brotschneidemaschine) in einem ordnungsgem√§√üen Zustand?",
  "Sind Elektroleitungen intakt und bilden keine Stolperstellen?",
  "Ist das freistehende Handwaschbecken ohne Besch√§digungen?",
  "Entspricht die Zuleitung der VDE-Norm?",
  "Ist der Backhandschuh f√ºr die Backstation in einem ordnungsgem√§√üen Zustand (kein Verschlei√ü) und besitzt eine lange Stulpe?",
  "Sind alle Hei√üger√§te (z.B. Hei√ütheken, Fritteusen) in technisch einwandfreiem Zustand?",
  "H√§ngt der Hautschutzplan aus?",
  "Werden Hautschutz- und Hautpflegeprodukte zur Verf√ºgung gestellt?",
  "Sind die Arbeitsger√§te im Servicebereich in einem ordnungsgem√§√üen Zustand?",
  "Sind Glast√ºren und Glasw√§nde in Augenh√∂he gekennzeichnet?",
  "Werden Schneidbretter und Messer regelm√§√üig gereinigt und farbcodiert verwendet?",
  "Werden Schneidbretter mit Messereinschub verwendet?",
  "Werden Messerhalter verwendet?",
  "Sind Convenience-Ger√§te in einem ordnungsgem√§√üen Zustand?",
  "Ist der Fu√üboden im Kassenbereich ohne sichtbare Besch√§digungen?",
  "Ist der Fu√üraum frei von Gegenst√§nden?",
  "Ist das Transportband unbesch√§digt und weist keine L√ºcke von √ºber 5mm auf?",
  "Sind die Kassenst√ºhle in einem funktionsf√§higen Zustand?",
  "Sind die serienm√§√üig eingebauten Heizger√§te im Kassenraum nicht durch brennbares Material zugestellt?",
  "Ist in den K√ºhlh√§usern an der Beleuchtung die √úberglocke vorhanden?",
  "Ist die Notentriegelung an K√ºhlhaust√ºren vorhanden und in Ordnung?",
  "Sind die K√ºhlhaust√ºren von innen mit dem Rettungswegschild ISO7010 gekennzeichnet?",
  "Funktioniert die Beleuchtung einwandfrei?",
  "Ist die Notruf-Funktion (wenn vorhanden) in Ordnung und ohne Besch√§digungen?",
  "Sind Schwerlastregale gepr√ºft?",
  "Ist der Anfahrschutz an den Schwerlastregalen vorhanden?",
  "Ist die Traglastangabe an den Schwerlastregalen vorhanden?",
  "Befindet sich eine Absturzsicherung an der Rampe?",
  "Ist die Absturzsicherung an der Rampe in einem ordnungsgem√§√üen Zustand (keine sichtbaren Besch√§digungen, Kennzeichnung)?",
  "Ist die M√ºll-/Papierpresse gepr√ºft?",
  "Ist die M√ºll-/Papierpresse in einem ordnungsgem√§√üen Zustand (keine sichtbaren Besch√§digungen, intakte Schutzeinrichtungen, fester Stand)?",
  "Liegen die aushangpflichtigen Gesetze, Unfallverh√ºtungsvorschriften und Brandschutzordnung Teil A im Sozialbereich aus?",
  "Sind Kaffeemaschine und andere hitzeentwickelnde Ger√§te auf einer nicht brennbaren Unterlage abgestellt?",
  "Ist der Erste-Hilfe-Koffer gut sichtbar an einer geeigneten Stelle montiert?",
  "Werden ortsver√§nderliche elektrische Betriebsmittel in angemessenen Zeitabst√§nden gepr√ºft?",
  "Liegt eine aktuelle Liste sowie Pr√ºfberichte pr√ºfungsbed√ºrftiger Einrichtungen vor?",
  "Ist der Verbandskasten in einem ordnungsgem√§√üen Zustand?",
  "Wird die Dokumentation √ºber Erste Hilfeleistungen gef√ºhrt?",
  "Sind Ma√ünahmen getroffen, die den Anreiz zu Raub√ºberf√§llen vermindern (z.B. T√ºrspion, feststehender Knauf)?",
  "Ist die T√ºr w√§hrend des Umgangs mit Zahlungsmitteln verschlossen?",
  "Werden neue Mitarbeiter vor Aufnahme der T√§tigkeit zum Thema Arbeitssicherheit und Brandschutz unterwiesen?",
  "Ist w√§hrend der gesamten Laden√∂ffnungszeit mindestens ein Mitarbeiter mit der Qualifikation zum Ersthelfer anwesend?",
  "Ist w√§hrend der gesamten Laden√∂ffnungszeit mindestens ein Mitarbeiter mit der Qualifikation als Brandschutzhelfer anwesend?",
  "Ist ein Sicherheitsbeauftragter ausgebildet und bestellt?",
  "Wurde die Gef√§hrdungsbeurteilung (GBO) erstellt und ist sie auf dem aktuellen Stand?",
  "Wurden Personen, die sich im Bereich von K√ºhlanlagen oder K√ºhlh√§usern aufhalten, unterwiesen?",
  "Sind die Sensoren nicht mit Material oder sonstigen Gegenst√§nden verstellt?",
  "Sind alle Sicherheitsvorrichtungen (Alarmleuchten, Kennzeichnungen, K√ºhlhaust√ºren) intakt?",
  "Wurde die Unterweisung von Praktikanten und Sch√ºleraushilfen durchgef√ºhrt?",
  "Haben die Personen die Inhalte der Unterweisung verstanden?",
  "Wurde die Unterweisung schriftlich dokumentiert?",
  "Wird den Besch√§ftigten arbeitsmedizinische Vorsorge angeboten?",
  "Sind Ma√ünahmen gegen Hauterkrankungen getroffen?",
  "Werden W√ºnsche der Besch√§ftigten bei der Arbeitsplanung ber√ºcksichtigt?",
  "Ist die Pausenregelung umgesetzt?",
  "Ist ein Pausenraum vorhanden?",
  "Werden √úberstunden gering gehalten?",
  "Werden regelm√§√üige Teambesprechungen durchgef√ºhrt?",
  "Werden neue Mitarbeiter eingearbeitet?",
  "Ist eine Unterweisung zum Thema Band- und Arbeitsschutz erfolgt?",
  "H√§ngt ein schwarzes Brett im Sozialraum oder Kassenb√ºro?",
  "Werden Entscheidungen transparent erl√§utert?",
  "Gibt es positive R√ºckmeldungen bei guter Leistung?",
  "Wird konstruktive Kritik ge√ºbt?",
  "Wurden Weiterbildungsm√∂glichkeiten geschaffen bzw angeboten?",
  "Gibt es einen Aushang zur Information √ºber die Suchtpr√§vention?",
  "Ist ein betriebliches Wiedereingliederungsmanagement implementiert?",
  "Wird Alleinarbeit vermieden?",
  "Ist die Betreuung nach einem √úberfall organisiert?",
  "Werden Schulungen f√ºr den Umgang mit gewaltt√§tigen Situationen erm√∂glicht?"
];
 // Tabelle bef√ºllen
    const tbody = document.querySelector('#checklist tbody');
    fragen.forEach((f, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td>${i + 1}</td>
            <td>${f}</td>
            <td class="checkbox"><input type="checkbox"></td>
            <td class="checkbox"><input type="checkbox"></td>
            <td><textarea></textarea></td>`;
        tbody.appendChild(tr);
    });

    // Safari Share API
    const shareBtn = document.getElementById('shareBtn');
    if (navigator.share) {
        shareBtn.style.display = 'inline-block';
        shareBtn.addEventListener('click', async () => {
            try { await navigator.share({ title: 'Sicherheits-Checkliste', url: window.location.href }); }
            catch (err) { console.error(err); }
        });
    }

    // Druckfunktion
    document.getElementById('printBtn').addEventListener('click', () => window.print());

    // PDF-Generierung per Button
    document.getElementById('pdfBtn').addEventListener('click', () => generatePDF(false));

    // Generieren und Teilen auf iPad
    async function generateAndSharePDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p','pt','a4');
        await doc.html(document.querySelector('.container'), { x:20, y:20, html2canvas:{scale:0.5} });
        const blob = doc.output('blob');
        const file = new File([blob], 'Sicherheits-Checkliste.pdf', { type: 'application/pdf' });
        if (navigator.canShare && navigator.canShare({ files: [file] })) {
            try {
                await navigator.share({ files: [file], title: 'Sicherheits-Checkliste', text: 'Hier ist die Checkliste.' });
            } catch (err) { console.error('Teilen fehlgeschlagen', err); }
        } else {
            alert('Teilen nicht unterst√ºtzt.');
        }
    }

    // PDF-G nur speichern oder √∂ffnen
    function generatePDF(open) {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p','pt','a4');
        doc.html(document.querySelector('.container'), {
            callback: pdf => {
                if (open) window.open(pdf.output('bloburl')); else pdf.save('Sicherheits-Checkliste.pdf');
            }, x:20, y:20, html2canvas:{scale:0.5}
        });
    }

    // Mail-Funktion
    document.getElementById('mailBtn').addEventListener('click', () => {
        const subject = encodeURIComponent('Sicherheits-Checkliste');
        const body = encodeURIComponent(window.location.href);
        window.location.href = `mailto:?subject=${subject}&body=${body}`;
    });

    // PDF teilen Shortcut f√ºr iPad-Button
    document.querySelector('.custom-btn').addEventListener('click', generateAndSharePDF);
});
</script>
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker
        .register('sw.js')
        .then(() => console.log("‚úÖ Service Worker registriert"))
        .catch((err) => console.error("‚ùå Service Worker Fehler:", err));
    });
  }
</script>
</body>
</html>
